---
  - name: oVirt Infra
    hosts: localhost
    connection: local

    taks:
      - name: Obtain SSO token with using username/password credentials
        ovirt_auth:
          url: https://rhvm.example.com/ovirt-engine/api
          username: admin@internal
          password: "{{ ovirt_password }}"

      - name: Creates a new Virtual Machine from template named 'rhel7'
        ovirt_vms:
          state: present
          name: mytestvm001
          template: RHEL7
          cluster: Default

      - name: Always revoke the SSO token
        ovirt_auth:
          state: absent
          ovirt_auth: "{{ ovirt_auth }}"
